<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
  </configSections>

  <appSettings>
  </appSettings>

  <log4net>
    <!--错误日志配置-->
    <appender name="ErrorAppender" type="log4net.Appender.RollingFileAppender">
      <!--日志路径-->
      <param name="File" value="Log\\LogError\\" />
      <!--是否覆盖，默认是追加true-->
      <param name="AppendToFile" value="true" />
      <!--设置无限备份=-1-->
      <!--<param name="MaxSizeRollBackups" value="-1" />-->
      <param name="MaxSizeRollBackups" value="500" />
      <!--单个日志最大尺寸-->
      <!--<param name="MaxFileSize" value="1048576" />-->
      <param name="MaximumFileSize" value="500KB" />
      <!--是否固定名字，只写到一个文件中-->
      <param name="StaticLogFileName" value="false" />
      <!--配置日志名字格式-->
      <!--<param name="DatePattern" value="yyyy-MM-dd&quot;.log&quot;"/>-->
      <param name="DatePattern" value="yyyy-MM-dd&quot;.txt&quot;" />
      <!--滚动(日志分割)类型-->
      <!--<param name="RollingStyle" value="Date" />-->
      <param name="RollingStyle" value="Composite" />
      <!--文件的编码-->
      <param name="Encoding" value="utf-8" />
      <!--为空默认情况下会独占日志文件，不能被File.Open，通过"log4net.Appender.FileAppender+MinimalLock"使用最小锁定模型以允许多个进程可以写入同一个文件-->
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <layout type="log4net.Layout.PatternLayout">
        <!--日志格式-->
        <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss,fff} - %m%n%n" />
      </layout>
    </appender>
    <!--消息日志配置-->
    <appender name="InfoAppender" type="log4net.Appender.RollingFileAppender">
      <!--日志路径-->
      <param name="File" value="Log\\LogInfo\\" />
      <!--是否覆盖，默认是追加true-->
      <param name="AppendToFile" value="true" />
      <!--设置无限备份=-1-->
      <!--<param name="MaxSizeRollBackups" value="-1" />-->
      <param name="MaxSizeRollBackups" value="500" />
      <!--单个日志最大尺寸-->
      <!--<param name="MaxFileSize" value="1048576" />-->
      <param name="MaximumFileSize" value="500KB" />
      <!--是否固定名字，只写到一个文件中-->
      <param name="StaticLogFileName" value="false" />
      <!--配置日志名字格式-->
      <!--<param name="DatePattern" value="yyyy-MM-dd&quot;.log&quot;"/>-->
      <param name="DatePattern" value="yyyy-MM-dd&quot;.txt&quot;" />
      <!--滚动(日志分割)类型-->
      <!--<param name="RollingStyle" value="Date" />-->
      <param name="RollingStyle" value="Composite" />
      <!--文件的编码-->
      <param name="Encoding" value="utf-8" />
      <!--为空默认情况下会独占日志文件，不能被File.Open，通过"log4net.Appender.FileAppender+MinimalLock"使用最小锁定模型以允许多个进程可以写入同一个文件-->
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <layout type="log4net.Layout.PatternLayout">
        <!--日志格式-->
        <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss,fff} - %m%n%n" />
      </layout>
    </appender>
    <!--调试日志配置-->
    <appender name="DebugAppender" type="log4net.Appender.RollingFileAppender">
      <!--日志路径-->
      <param name="File" value="Log\\LogDebug\\" />
      <!--是否覆盖，默认是追加true-->
      <param name="AppendToFile" value="true" />
      <!--设置无限备份=-1-->
      <!--<param name="MaxSizeRollBackups" value="-1" />-->
      <param name="MaxSizeRollBackups" value="500" />
      <!--单个日志最大尺寸-->
      <!--<param name="MaxFileSize" value="1048576" />-->
      <param name="MaximumFileSize" value="500KB" />
      <!--是否固定名字，只写到一个文件中-->
      <param name="StaticLogFileName" value="false" />
      <!--配置日志名字格式-->
      <!--<param name="DatePattern" value="yyyy-MM-dd&quot;.log&quot;" />-->
      <param name="DatePattern" value="yyyy-MM-dd&quot;.txt&quot;" />
      <!--滚动(日志分割)类型-->
      <!--<param name="RollingStyle" value="Date" />-->
      <param name="RollingStyle" value="Composite" />
      <!--文件的编码-->
      <param name="Encoding" value="utf-8" />
      <!--为空默认情况下会独占日志文件，不能被File.Open，通过"log4net.Appender.FileAppender+MinimalLock"使用最小锁定模型以允许多个进程可以写入同一个文件-->
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <layout type="log4net.Layout.PatternLayout">
        <!--日志格式-->
        <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss,fff} - %m%n%n" />
      </layout>
    </appender>

    <!--log4net.LogManager.GetLogger("logerror")用这个来选择这种类型-->
    <!--指定logger的设置，additivity指示是否遵循缺省的继承机制,去掉additivity=false日志会有重复-->
    <logger name="logerror" additivity="false">
      <appender-ref ref="ErrorAppender" />
    </logger>
    <logger name="loginfo" additivity="false">
      <appender-ref ref="InfoAppender" />
    </logger>
    <logger name="logdebug" additivity="false">
      <appender-ref ref="DebugAppender" />
    </logger>

    <root>
      <!--所有logger继承此级别不单独设置，开发环境DEBUG，生产环境INFO-->
      <level value="ALL" />
      <appender-ref ref="ConsoleAppender" />
    </root>
  </log4net>

  <system.web>
    <compilation debug="true" targetFramework="4.5" />
    <!--此处添加requestValidationMode="2.0" InvokeActionFilter接口访问日志需要，因参数中存在xml-->
    <httpRuntime maxRequestLength="40960" executionTimeout="360" requestValidationMode="2.0" enableVersionHeader="false" />
    <!--validationKey【569BD5BA91AEA335B4655E59F383969BDFE44F88】和decryptionKey【6CEAFA9E0083C7571023243FD3489D16887C80ADB6CD29E7】-->
    <machineKey validation="MD5" validationKey="569BD5BA91AEA335B4655E59F383969BDFE44F89" decryption="AES" decryptionKey="6CEAFA9E0083C7571023243FD3489D16887C80ADB6CD29E8" />
    <!--<authentication mode="Windows"/>-->
    <authentication mode="Forms">
      <forms loginUrl="/admin/Login" defaultUrl="/admin/login" name="Cysoft.Auth" protection="All" cookieless="UseCookies" slidingExpiration="true" />
    </authentication>

    <customErrors mode="RemoteOnly" defaultRedirect="/Error">
      <error statusCode="403" redirect="/Error?id=403" />
      <error statusCode="404" redirect="/Error?id=404" />
    </customErrors>
    <pages controlRenderingCompatibilityVersion="4.0" validateRequest="false" clientIDMode="AutoID">
      <!--<namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Optimization" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />
        <add namespace="System.Web.WebPages" />
      </namespaces>-->
    </pages>

    <globalization requestEncoding="utf-8" responseEncoding="utf-8" fileEncoding="utf-8" />
    <!--<sessionState mode="StateServer" stateConnectionString="tcpip=127.0.0.1:42424" sqlConnectionString="data source=127.0.0.1;Trusted_Connection=yes" cookieless="false" timeout="120" />-->
    <sessionState mode="InProc" stateConnectionString="tcpip=127.0.0.1:42424" sqlConnectionString="data source=127.0.0.1;Trusted_Connection=yes" cookieless="false" timeout="120" />
  </system.web>
  <system.webServer>

    <!--★★★ TODO：YZQ测试时允许跨域 ★★★-->
    <httpProtocol>
      <customHeaders>
        <remove name="X-Powered-By" />
        <remove name="Access-Control-Allow-Methods" />
        <remove name="Access-Control-Allow-Headers" />
        <remove name="Access-Control-Allow-Origin" />
        <add name="Access-Control-Allow-Methods" value="POST,GET,OPTIONS" />
        <add name="Access-Control-Allow-Headers" value="x-requested-with,content-type" />
        <add name="Access-Control-Allow-Origin" value="*" />
      </customHeaders>
    </httpProtocol>

    <validation validateIntegratedModeConfiguration="false" />
    <modules runAllManagedModulesForAllRequests="true" />
    <handlers>
      <remove name="ExtensionlessUrl-Integrated-4.0" />
      <remove name="ExtensionlessUrl-ISAPI-4.0_32bit " />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
      <!--<add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />-->
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="*" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
      <remove name="OPTIONSVerbHandler" />
      <remove name="TRACEVerbHandler" />
    </handlers>

    <staticContent>
      <!-- 字体文件 必须先remove防止和IIS原配置冲突 -->
      <remove fileExtension=".svg" />
      <mimeMap fileExtension=".svg" mimeType="image/svg+xml" />
      <remove fileExtension=".woff" />
      <mimeMap fileExtension=".woff" mimeType="application/x-font-woff" />
      <remove fileExtension=".woff2" />
      <mimeMap fileExtension=".woff2" mimeType="application/x-font-woff" />
    </staticContent>
  </system.webServer>
  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:6 /nowarn:1659;1699;1701" />
      <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:14 /nowarn:41008 /define:_MYTYPE=\&quot;Web\&quot; /optionInfer+" />
    </compilers>
  </system.codedom>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-1.6.5135.21930" newVersion="1.6.5135.21930" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Antlr3.Runtime" publicKeyToken="eb42632606e9261f" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-3.5.0.2" newVersion="3.5.0.2" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-12.0.0.0" newVersion="12.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-5.2.7.0" newVersion="5.2.7.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration>